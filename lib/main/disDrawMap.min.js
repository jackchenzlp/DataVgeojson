let show=true;let drawok=false;let GlobalMarkerObjArr=[];let GlobalLoadObjArr=[];let GlobalGeojsonObj={type:"FeatureCollection",features:[]};let GlobalEditor_DarwGeojsonObj={type:"FeatureCollection",features:[]};var count=0;var radius=0;let darwState=false;let control;var GaoDeNormalm=L.tileLayer.chinaProvider("GaoDe.Normal.Map",{maxZoom:32,minZoom:3,attribution:"Map data &copy; 高德 contributors"});var GaoDeImgm=L.tileLayer.chinaProvider("GaoDe.Satellite.Map",{maxZoom:32,minZoom:3,attribution:"Map data &copy; 高德影像 contributors"});var GaoDeImga=L.tileLayer.chinaProvider("GaoDe.Satellite.Annotion",{maxZoom:32,minZoom:3});var GoogleNormalm=L.tileLayer.chinaProvider("Google.Normal.Map",{maxZoom:32,minZoom:3,attribution:"Map data &copy; 谷歌 contributors"});var GoogleImgm=L.tileLayer.chinaProvider("Google.Satellite.Map",{maxZoom:32,minZoom:3,attribution:"Map data &copy; 谷歌影像 contributors"});var GoogleImga=L.tileLayer.chinaProvider("Google.Satellite.Annotion",{maxZoom:32,minZoom:3});var GaoDeNormal=L.layerGroup([GaoDeNormalm]),GaoDeImage=L.layerGroup([GaoDeImgm,GaoDeImga]);var GoogleNormal=L.layerGroup([GoogleNormalm]),GoogleImage=L.layerGroup([GoogleImgm,GoogleImga]);var map=L.map("map",{worldCopyJump:true,cursor:false,center:[35.13,104.2],zoom:4,layers:[GaoDeNormal],zoomControl:true,contextmenu:true,contextmenuWidth:140,contextmenuItems:[{text:"添加Marker",callback:addMarker},{text:"添加Cricel",callback:addCricel}]});var baseLayers={"<span style='color: gray'>高德地图</span>":GaoDeNormal,"<span style='color: gray'>高德影像</span>":GaoDeImage,"<span style='color: gray'>谷歌地图</span>":GoogleNormal,"<span style='color: gray'>谷歌影像</span>":GoogleImage};var DrawFeatuerGroup=(new L.featureGroup).addTo(map);var FileFeatuerGroup=(new L.featureGroup).addTo(map);var Marker_L_FeatuerGroup=(new L.featureGroup).addTo(map);overlays={"测绘点坐标层":FileFeatuerGroup,"绘图层":DrawFeatuerGroup,"图标层":Marker_L_FeatuerGroup};var initMarker=L.marker([39.90553,116.391305]).addTo(map).bindPopup("<p>纠偏参照物WGS84坐标下,天安门广场国旗所在位置</p>");GlobalMarkerObjArr.push(initMarker);count=count++;Marker_L_FeatuerGroup.addLayer(initMarker);L.control.scale({position:"bottomright"}).addTo(map);L.control.browserPrint({position:"topleft",title:"Print ..."}).addTo(map);(function(window){"use strict";function initMap(){var L=window.L;var style={stroke:true,color:"#ff0000",weight:1,opacity:1,fillOpacity:.5,fillColor:"#ff0000",radius:5,clickable:false};L.Control.FileLayerLoad.LABEL='<img class="icon" src="./folder.svg" alt="file icon"/>';control=L.Control.fileLayerLoad({fitBounds:true,flyTo:true,layerOptions:{style:function(geoJsonFeature){if(JSON.stringify(geoJsonFeature.properties)=="{}"){return style}if(!geoJsonFeature.properties["stroke"]&&JSON.stringify(geoJsonFeature.properties)!=="{}"){return style}if(JSON.stringify(geoJsonFeature.properties)!=="{}"&&geoJsonFeature.properties["stroke"]){var weight;var opacity;var color;var fillColor;var fillOpacity;if(geoJsonFeature.properties["stroke-width"]){weight=geoJsonFeature.properties["stroke-width"]}if(geoJsonFeature.properties["stroke-opacity"]){opacity=geoJsonFeature.properties["stroke-opacity"]}if(geoJsonFeature.properties["stroke"]){color=geoJsonFeature.properties["stroke"]}if(geoJsonFeature.properties["fill"]){fillColor=geoJsonFeature.properties["fill"]}if(geoJsonFeature.properties["fill-opacity"]){fillOpacity=geoJsonFeature.properties["fill-opacity"]}return{weight:weight,opacity:opacity,color:color,fillColor:fillColor,fillOpacity:fillOpacity}}},pointToLayer:function(feature,latlng){var styleForThisFeature=cricelStyle(feature);var circleMarker=L.circleMarker(latlng,styleForThisFeature);return circleMarker},onEachFeature:(feature,layer)=>{if(onEachFeature){onEachFeature(feature,layer)}}}});control.addTo(map);control.loader.on("data:loaded",function(e){if(e.layer){var gpsKmlGeojsonArr=this.options.GpsKmlGeojsonArr;var layerArr=this.options.layerArr;var idArr=[];for(let i=0;i<layerArr.length;i++){var layerObj=layerArr[i];FileFeatuerGroup.addLayer(layerObj);layerObj.eachLayer(function(layer){GlobalLoadObjArr.push(layer);var name_id=layer.feature.properties.name;var layer_id=layerObj.getLayerId(layer);var id={name:name_id,layerID:layer_id};idArr.push(id)})}for(var i=0;i<gpsKmlGeojsonArr.length;i++){var geojson=gpsKmlGeojsonArr[i];for(var j=0;j<geojson.features.length;j++){var feature=geojson.features[j];if(feature.properties.name==idArr[j].name||feature.properties.name==idArr[j].layerID){feature.properties.id=idArr[j].layerID}}}var showHighlight=false;addGeojsonArrToCodeMirror(gpsKmlGeojsonArr,showHighlight)}else{return}})}window.addEventListener("load",function(){initMap()})})(window);L.control.layers(baseLayers,overlays).addTo(map);var title=new L.Control({position:"bottomleft"});title.onAdd=function(map){this._div=L.DomUtil.create("div","info");this.update();return this._div};title.update=function(){var scale=map.getZoom();var center=latlngFixedCoordinate(map.getCenter());var mouse=latlngFixedCoordinate(map.getCenter());title.update=function(){this._div.innerHTML='<div class="leaflet-control-attribution leaflet-control">'+"当前层:"+scale+" "+"|"+" "+"中心坐标: "+center+"|"+"latlng:"+mouse+"</div>"}};title.addTo(map);map.pm.addControls({position:"topleft",drawCircle:true,cutPolygon:false,rotateMode:false});map.pm.enableDraw("Polygon",{snappable:true,snapDistance:20});map.pm.disableDraw();map.on("pm:create",e=>{var layer=e.layer;var layerType=e.shape;DrawFeatuerGroup.addLayer(layer);if(e.layer&&e.layer instanceof L.Circle){e.layer.on("pm:markerdragstart",markerfncOn)}setLayerProperties(layer,layerType);showDrawToMirror(layer);var json=getLayerAttrbuter(layer);if(json!==null){bindPopupDraw(layer)}layer.on("pm:edit",e=>{var layer=e.layer;var layerType=e.shape;setLayerProperties(layer,layerType);updataGlobalEditorDarwGeojsonObj(layer,layerType);var geojson=JSON.stringify(GlobalEditor_DarwGeojsonObj,null,4);showGeojsonStrToMirror(geojson)});layer.on("pm:remove",function(x){deleteDrawLayer(layer)})});map.pm.setGlobalOptions({});var circleLayer=null;const markerfncOn=e=>{circleLayer=e.layer;layerType=e.layerType;const{markerEvent}=e;markerEvent.target.on("drag",()=>{radius=circleLayer.getRadius().toFixed(2)})};map.on("pm:drawstart",e=>{if(map.pm.Draw.Circle._hintMarker&&e.shape==="Circle"){map.pm.Draw.Circle._hintMarker.on("move",getCircleDrawRadius)}darwState=true});map.on("pm:drawend",e=>{if(map.pm.Draw.Circle._hintMarker){map.pm.Draw.Circle._hintMarker.off("move",getCircleDrawRadius)}darwState=false});map.on("moveend",function(e){let scale=e.target.getZoom();var center=latlngFixedCoordinate(map.getCenter());var mouse=latlngFixedCoordinate(map.getCenter(e.latlng));title.update=function(){this._div.innerHTML='<div class="leaflet-control-attribution leaflet-control" style="margin-bottom: 0px;">'+"当前层:"+scale+" "+"|"+" "+"中心坐标: "+center+"|"+"纬度"+"|"+"经度:"+mouse+"</div>"};title.addTo(map)});map.on("zoomend",e=>{let scale=e.target.getZoom();var center=latlngFixedCoordinate(map.getCenter());var mouse=latlngFixedCoordinate(map.getCenter(e.latlng));title.update=function(){this._div.innerHTML='<div class="leaflet-control-attribution leaflet-control">'+"当前层:"+scale+" "+"|"+" "+"中心坐标: "+center+"|"+"纬度"+"|"+"经度:"+mouse+"</div>";map.panTo(map.wrapLatLng(map.getCenter()),{animate:false})};title.addTo(map);if(GlobalMarkerObjArr.length>0){if(scale>19&&show==true){GlobalMarkerObjArr.forEach((item,index)=>{map.removeLayer(item)});Marker_L_FeatuerGroup.clearLayers();show=false}else if(scale<19&&show==false){GlobalMarkerObjArr.forEach((item,index)=>{map.addLayer(item);Marker_L_FeatuerGroup.addLayer(item)});show=true}}});map.on("mousemove",function(e){let scale=e.target.getZoom();var center=latlngFixedCoordinate(map.getCenter());var mouse=latlngFixedCoordinate(e.latlng);title.update=function(){this._div.innerHTML='<div class="leaflet-control-attribution leaflet-control">'+"当前层:"+scale+" "+"|"+" "+"中心坐标: "+center+"|"+"纬度"+"|"+"经度:"+mouse+"</div>"};title.addTo(map)});function pointToFeature(coordinates,properties,options){return feature({type:"Point",coordinates:coordinates},properties,options)}const feature=function(geometry,properties,options){var feat={type:"Feature"};feat.properties=properties||{};feat.geometry=geometry;return feat};function featureCollection(features){var fc={type:"FeatureCollection"};fc.features=features;return fc}function addMarker(e){if(!show){alert("图层大于19层不准添加Marker,请缩小图层至18层以上在添加");return}var latlng=getCoordinate_latlng(e);var marker=new L.Marker(latlng,{draggable:true});map.addLayer(marker);marker.bindPopup(popupMarker).on("popupopen",e=>{markerPopupEvent(latlng,marker)});GlobalMarkerObjArr.push(marker);Marker_L_FeatuerGroup.addLayer(marker);marker.on("dragend",function(e){updateLatLng(marker)});marker.on("drag",function(e){marker.openPopup();updateLatLng(marker)});marker.on("click",function(e){marker.openPopup();updateLatLng(marker)})}var nameID=1e4;function addCricel(e){var geolayer;var lnglat=[];var geojsonArr=[];var coordinate=getCoordinate_lnglat(e);var properties={name:`${nameID++}`,id:0};var Feature=pointToFeature(coordinate,properties);lnglat.push(Feature);var geofeatures=featureCollection(lnglat);if(typeof geofeatures==="string"){geofeatures=JSON.parse(geofeatures)}geojsonArr.push(geofeatures);var drag=false;geolayer=new L.geoJson(geofeatures,{pointToLayer:function(feature,latlng){var styleForThisFeature=cricelStyle(feature);var circleMarker=L.circleMarker(latlng,styleForThisFeature);function trackMouse(e){circleMarker.setLatLng(e.latlng);updateGeojsonLatLng(circleMarker)}circleMarker.on("mousedown",e=>{if(!darwState){map.dragging.disable();circleMarker.openPopup();trackMouse(e);map.dragging.disable();map.on("mousemove",e=>{trackMouse(e);drag=true})}});circleMarker.on("mouseup",e=>{if(!darwState){map.dragging.enable();map.removeEventListener("mousemove");trackMouse(e);if(drag){updataGlobalLoadObjArr(circleMarker);GlobalLoadObjArr.push(circleMarker);var result=updataGlobalGeojsonObj(circleMarker);if(GlobalEditor_FileGeojson){GlobalEditor_FileGeojson.setValue(result)}}drag=false}});GlobalLoadObjArr.push(circleMarker);return circleMarker},onEachFeature:(feature,layer)=>{if(onEachFeature){onEachFeature(feature,layer)}}});if(geolayer.getLayers().length===0){throw new Error("GeoJSON has no valid layers.")}geolayer.addTo(map);FileFeatuerGroup.addLayer(geolayer);geojsonArr=changeGeojsonID(geojsonArr,geolayer);var showHighlight=false;addGeojsonArrToCodeMirror(geojsonArr,showHighlight)}function changeGeojsonID(arr,geolayer){var name_id;var layer_id;if(arr.length>0){geolayer.eachLayer(function(layer){name_id=layer.feature.properties.name;layer_id=geolayer.getLayerId(layer)});for(var i=0;i<arr.length;i++){var geojson=arr[i];for(var j=0;j<geojson.features.length;j++){var feature=geojson.features[i];if(feature.properties.name==name_id){feature.properties.id=layer_id}}}}return arr}function updateLatLng(marker,reverse){if(reverse){marker.setLatLng([marker.getLatLng().lat,marker.getLatLng().lng]);map.panTo([marker.getLatLng().lat,marker.getLatLng().lng])}else{var markerID=getlayerID(marker);$(".marker-id").val(markerID.toString());$(".marker-lat").val(marker.getLatLng().lat.toFixed(10));$(".marker-lng").val(marker.getLatLng().lng.toFixed(10));marker.setLatLng([marker.getLatLng().lat,marker.getLatLng().lng]);$(".removeMarker").on("click",e=>{e.preventDefault();removeMarker(marker)});$(".cancelMarker").on("click",e=>{e.preventDefault();map.closePopup()})}}function updateGeojsonLatLng(circleMarker,reverse){if(reverse){circleMarker.setLatLng([circleMarker.getLatLng().lat,circleMarker.getLatLng().lng]);map.panTo([circleMarker.getLatLng().lat,circleMarker.getLatLng().lng])}else{var circleMarker_id=getlayerID(circleMarker);$(".circleMarker-id").val(circleMarker_id.toString());$(".circleMarker-lat").val(circleMarker.getLatLng().lat.toFixed(10));$(".circleMarker-lng").val(circleMarker.getLatLng().lng.toFixed(10));circleMarker.setLatLng([circleMarker.getLatLng().lat.toFixed(10),circleMarker.getLatLng().lng.toFixed(10)]);$(".removeCircleMarker").on("click",e=>{e.preventDefault();deleteLoadLayer(circleMarker)});$(".cancelCircleMarker").on("click",e=>{e.preventDefault();map.closePopup()})}}function getlayerID(layer){var marker_id;$.each(map._layers,function(ml){if(map._layers[ml]===layer){marker_id=L.stamp(map._layers[ml])}});return marker_id}function updataGlobalLoadObjArr(circleMarker){var circelMarker_id;GlobalLoadObjArr.forEach((item,index)=>{if(item._leaflet_id==circleMarker._leaflet_id){circelMarker_id=item._leaflet_id}GlobalLoadObjArr=GlobalLoadObjArr.filter(item=>item._leaflet_id!==circelMarker_id)})}function updataGlobalGeojsonObj(circleMarker){if(GlobalGeojsonObj.features.length>0){var circleMarker_id=getlayerID(circleMarker);for(var i=0;i<GlobalGeojsonObj.features.length;i++){var geojson=GlobalGeojsonObj.features[i];if(geojson.properties.id==circleMarker_id){var coords=[circleMarker.getLatLng().lng.toFixed(10)*1,circleMarker.getLatLng().lat.toFixed(10)*1];geojson.geometry.coordinates=coords}}}var result=JSON.stringify(GlobalGeojsonObj,null,4);return result}function removeMarker(marker){var markerID;GlobalMarkerObjArr.forEach((item,index)=>{if(item==marker){markerID=item._leaflet_id;map.removeLayer(item)}GlobalMarkerObjArr=GlobalMarkerObjArr.filter(item=>item._leaflet_id!==markerID)})}function cricelStyle(feature){return{stroke:true,color:"#ff0000",weight:1,opacity:1,fillOpacity:.5,fillColor:"#ff0000",radius:5,clickable:false,riseOnHover:true,draggable:true}}function deleteLoadLayer(layer){var layer_id;if(GlobalLoadObjArr.length>0){GlobalLoadObjArr.forEach((item,index)=>{if(item._leaflet_id==layer._leaflet_id){layer_id=item._leaflet_id;map.removeLayer(item)}GlobalLoadObjArr=GlobalLoadObjArr.filter(item=>item._leaflet_id!==layer_id);GlobalGeojsonObj.features=GlobalGeojsonObj.features.filter(item=>item.properties.id!==layer_id)})}var result=JSON.stringify(GlobalGeojsonObj,null,4);if(GlobalEditor_FileGeojson){GlobalEditor_FileGeojson.setValue(result)}map.closePopup()}function addRow(){var currentRows=document.getElementById("tablePop").rows.length;var insertTr=document.getElementById("tablePop").insertRow(currentRows);var insertTd=insertTr.insertCell(0);insertTd.setAttribute("class","m-0 p-0");insertTd.innerHTML='<input  class ="form-control m-0 p-0" type="text" style="font-size: 12px;" value="">';insertTd=insertTr.insertCell(1);insertTd.setAttribute("class","m-0 p-0");insertTd.innerHTML='<input  class ="form-control m-0 p-0" type="text" style="font-size: 12px;" value="">'}function addRowProperties(){var currentRows=document.getElementById("tablePop").rows.length;var insertTr_1=document.getElementById("tablePop").insertRow(currentRows);var insertTd_1=insertTr_1.insertCell(0);insertTd_1.setAttribute("class","m-0 p-0");insertTd_1.innerHTML='<input  class ="form-control m-0 p-0" type="text" style="font-size: 12px;" value="stroke">';insertTd_1=insertTr_1.insertCell(1);insertTd_1.setAttribute("class","m-0 p-0");insertTd_1.innerHTML='<input type="color" id="color-stroke" class ="form-control m-0 p-0 mt-1" style="width: 100%; height: 10px" value="#ffffff">';var insertTr_2=document.getElementById("tablePop").insertRow(currentRows+1);var insertTd_2=insertTr_2.insertCell(0);insertTd_2.setAttribute("class","m-0 p-0");insertTd_2.innerHTML='<input  class ="form-control m-0 p-0" type="text" style="font-size: 12px;" value="stroke-width">';insertTd_2=insertTr_2.insertCell(1);insertTd_2.setAttribute("class","m-0 p-0");insertTd_2.innerHTML='<input id="stroke-width" class ="form-control m-0 p-0" type="text" style="font-size: 12px;" value="2">';var insertTr_3=document.getElementById("tablePop").insertRow(currentRows+2);var insertTd_3=insertTr_3.insertCell(0);insertTd_3.setAttribute("class","m-0 p-0");insertTd_3.innerHTML='<input  class ="form-control m-0 p-0" type="text" style="font-size: 12px;" value="stroke-opacity">';insertTd_3=insertTr_3.insertCell(1);insertTd_3.setAttribute("class","m-0 p-0");insertTd_3.innerHTML='<input id="stroke-opacity" class ="form-control m-0 p-0" type="text" style="font-size: 12px;" value="1">';var insertTr_4=document.getElementById("tablePop").insertRow(currentRows+3);var insertTd_4=insertTr_4.insertCell(0);insertTd_4.setAttribute("class","m-0 p-0");insertTd_4.innerHTML='<input  class ="form-control m-0 p-0" type="text" style="font-size: 12px;" value="fill">';insertTd_4=insertTr_4.insertCell(1);insertTd_4.setAttribute("class","m-0 p-0");insertTd_4.innerHTML='<input type="color" id="color-fill" class ="form-control m-0 p-0 mt-1" style="width: 100%; height: 10px" value="#ffffff">';var insertTr_5=document.getElementById("tablePop").insertRow(currentRows+4);var insertTd_5=insertTr_5.insertCell(0);insertTd_5.setAttribute("class","m-0 p-0");insertTd_5.innerHTML='<input  class ="form-control m-0 p-0" type="text" style="font-size: 12px;" value="fill-opacity">';insertTd_5=insertTr_5.insertCell(1);insertTd_5.setAttribute("class","m-0 p-0");insertTd_5.innerHTML='<input id="fill-opacity" class ="form-control m-0 p-0" type="text" style="font-size: 12px;" value="1">'}function markerPopupEvent(latlng,layer){var marker_id=getlayerID(layer);$(".marker-id").val(marker_id.toString());$(".marker-lat").val(latlng.lat.toFixed(10));$(".marker-lng").val(latlng.lng.toFixed(10));$(".removeMarker").on("click",e=>{e.preventDefault();removeMarker(layer)});$(".cancelMarker").on("click",e=>{e.preventDefault();map.closePopup()})}function popupEvent(feature,layer){if(feature.geometry.type==="Point"){$("tr.Polygon").hide();$("tr.LineString").hide()}if(feature.geometry.type==="Polygon"){$("tr.Point").hide();$("tr.LineString").hide()}if(feature.geometry.type==="LineString"){$("tr.Point").hide();$("tr.Polygon").hide()}var geolayer_id=getlayerID(layer);$("#addRow").on("click",e=>{e.preventDefault();addRow()});$("#addProperties").on("click",e=>{e.preventDefault();addRowProperties();popupStyleCangeEvent(layer);document.getElementById("addProperties").style.display="none"});$("#remove").on("click",e=>{e.preventDefault();deleteLoadLayer(layer)});$("#cancel").on("click",e=>{e.preventDefault();map.closePopup()});layer_id=getlayerID(layer);$("#save").on("click",e=>{e.preventDefault();var tableId="tablePop";var result;var tableArr=getTableValue(tableId);if(GlobalGeojsonObj.features.length>0){for(var i=0;i<GlobalGeojsonObj.features.length;i++){var geojson=GlobalGeojsonObj.features[i];if(geojson.properties.id==layer_id){var propertiesObj=geojson.properties;tableArr.forEach((item,index)=>{propertiesObj[item.name]=item.val});geojson.properties=propertiesObj}result=JSON.stringify(GlobalGeojsonObj,null,4);addGeojsonObjToCodeMirror(result);map.closePopup()}}});$("#properties button").click(function(e){e.preventDefault();$(this).tab("show");var idValue=e.target.id;switch(idValue){case"properties-tab":$("#save").prop("disabled",false);break;case"Info-tab":$(".circleMarker-id").val(geolayer_id.toString());if(feature.geometry.type==="Point"){$(".circleMarker-lat").val(layer.getLatLng().lat);$(".circleMarker-lng").val(layer.getLatLng().lng)}if(feature.geometry.type==="Polygon"){var json=getLayerAttrbuter(layer);if(json.area){$(".Polygon-Meters").val(json.area.toString());$(".Polygon-Kilometers").val((json.area/1e6).toFixed(2).toString())}}if(feature.geometry.type==="LineString"){var json=getLayerAttrbuter(layer);if(json.distance){$(".LineString-Meter").val(json.distance.toString());$(".LineString-Kilometer").val((json.distance/1e3).toFixed(2).toString())}}$("#save").prop("disabled",true);break}});(function(){$(".circleMarker-id").val(geolayer_id.toString());if(feature.geometry.type==="Point"){$(".circleMarker-lat").val(layer.getLatLng().lat);$(".circleMarker-lng").val(layer.getLatLng().lng)}if(feature.geometry.type==="Polygon"){var json=getLayerAttrbuter(layer);if(json.area){$(".Polygon-Meters").val(json.area.toString());$(".Polygon-Kilometers").val((json.area/1e6).toFixed(2).toString())}}if(feature.geometry.type==="LineString"){var json=getLayerAttrbuter(layer);if(json.distance){$(".LineString-Meter").val(json.distance.toString());$(".LineString-Kilometer").val((json.distance/1e3).toFixed(2).toString())}}})()}function popupStyleCangeEvent(layer){var att_button=getActiveLi("properties");var att_div=getActiveDiv("myproperties");if(att_button=="properties-tab"&&att_div=="properties-justified"){var style=layer.options;if(style){$("#color-stroke").val(style.color);$("#color-fill").val(style.fillColor);$("#stroke-width").val(style.weight);$("#stroke-opacity").val(style.opacity);$("#fill-opacity").val(style.fillOpacity)}$("#color-stroke").on("input",e=>{e.preventDefault();const btnStroke=document.getElementById("color-stroke");var colorStroke=btnStroke.value;layer.setStyle({color:colorStroke})});$("#color-fill").on("input",e=>{e.preventDefault();const btnfill=document.getElementById("color-fill");var fillColor=btnfill.value;layer.setStyle({fillColor:fillColor})});$("#stroke-width").on("input",e=>{e.preventDefault();const strokeWidth=document.getElementById("stroke-width");var weight=strokeWidth.value;layer.setStyle({weight:weight})});$("#stroke-opacity").on("input",e=>{e.preventDefault();const strokeOpacity=document.getElementById("stroke-opacity");opacity=strokeOpacity.value;layer.setStyle({opacity:opacity})});$("#fill-opacity").on("input",e=>{e.preventDefault();const fillOpacity=document.getElementById("fill-opacity");var opacity=fillOpacity.value;layer.setStyle({fillOpacity:opacity})})}}function latlngFixedCoordinate(coordinate){return"["+coordinate.lat.toFixed(10)+","+coordinate.wrap().lng.toFixed(10)+"]"}function getCoordinate_latlng(e){var latlng={};var lat=e.latlng.lat.toFixed(10);var lng=e.latlng.wrap().lng.toFixed(10);if(typeof lat=="string"||typeof lng=="string"){var latNum=lat*1;var lngNum=lng*1;latlng={lat:latNum,lng:lngNum}}else{latlng={lat:latNum,lng:lngNum}}return latlng}function getCoordinate_lnglat(e){var lnglat=[];var lat=e.latlng.lat.toFixed(10);var lng=e.latlng.wrap().lng.toFixed(10);if(typeof lat=="string"||typeof lng=="string"){var latNum=lat*1;var lngNum=lng*1;lnglat=[lngNum,latNum]}else{lnglat=[lng,lat]}return lnglat}function getTableValue(tableId){var tableArr=[];var name;var val;var obj=document.getElementById(tableId);for(var i=0;i<obj.rows.length;i++){if(obj.rows[i].cells[0].childNodes[0].value){name=obj.rows[i].cells[0].childNodes[0].value}if(obj.rows[i].cells[1].childNodes[0].value){val=obj.rows[i].cells[1].childNodes[0].value}if(name&&val){var cellVal={name:name,val:val};tableArr.push(cellVal)}}return tableArr}function geojsonExport(jsonData){let nodata='{"type":"FeatureCollection","features":[]}';let dataUri="data:application/json;charset=utf-8,"+encodeURIComponent(jsonData);let datenow=(new Date).getTime();let datenowstr=datenow.toString();let exportFileDefaultName="export_"+datenowstr+".geojson";let linkElement=document.createElement("a");linkElement.setAttribute("href",dataUri);linkElement.setAttribute("download",exportFileDefaultName);if(jsonData==nodata){alert("No features are drawn")}else{linkElement.click()}}function addToHighlightMarker(latlngArr){var x_circles=latlngArr[0];var y_circles=latlngArr[1];count=count+1;var _marker=L.marker([x_circles,y_circles],{highlight:"permanent",fillOpacity:.3}).bindPopup("测绘点"+count.toString()).addTo(map);return _marker}function getGeometryLatlng(features){var firstCordinateArr=[];for(var i=0;i<features.length;i++){if(features[i].geometry.type=="MultiPolygon"){var coordinates=features[i].geometry.coordinates;firstCordinateArr.push(coordinates[0][0])}else if(features[i].geometry.type=="Polygon"){var coordinates=features[i].geometry.coordinates;firstCordinateArr.push(coordinates[0][0])}else if(features[i].geometry.type=="MultiPoint"){var coordinates=features[i].geometry.coordinates;firstCordinateArr.push(coordinates[0])}else if(features[i].geometry.type=="Point"){var coordinates=features[i].geometry.coordinates;firstCordinateArr.push(coordinates)}else if(features[i].geometry.type=="LineString"){var coordinates=features[i].geometry.coordinates;firstCordinateArr.push(coordinates[0])}else if(features[i].geometry.type=="MultiLineString"){var coordinates=features[i].geometry.coordinates;firstCordinateArr.push(coordinates[0])}}return firstCordinateArr}function mergefile(inputs){for(var i=0;i<inputs.length;i++){var normalized=normalize(inputs[i]);for(var j=0;j<normalized.features.length;j++){GlobalGeojsonObj.features.push(normalized.features[j])}}return GlobalGeojsonObj}var types={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function normalize(gj){if(!gj||!gj.type)return null;var type=types[gj.type];if(!type)return null;if(type==="geometry"){return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:gj}]}}else if(type==="feature"){return{type:"FeatureCollection",features:[gj]}}else if(type==="featurecollection"){return gj}}function showFileCodeMirror(GeojsonArr){let geojsonObj={};if(GeojsonArr.length>0){for(let i=0;i<GeojsonArr.length;i++){let geojson=GeojsonArr[i];if(typeof geojson==="string"){geojsonObj=JSON.parse(geojson)}else{geojsonObj=geojson}var normalizeGeojson=mergefile(geojsonObj.features);var convertStr=JSON.stringify(normalizeGeojson);var result=JSON.stringify(JSON.parse(convertStr),null,4);if(GlobalEditor_FileGeojson){GlobalEditor_FileGeojson.setValue(result)}}}}function showHighlightMarker(GeojsonArr){let geojsonObj={};let geojson={};var coordinateArr=[];if(GeojsonArr.length>0){for(let i=0;i<GeojsonArr.length;i++){geojson=GeojsonArr[i];if(typeof geojson==="string"){geojsonObj=JSON.parse(geojson)}else{geojsonObj=geojson}coordinateArr=getGeometryLatlng(geojsonObj.features);for(let j=0;j<coordinateArr.length;j++){var coordArr=coordinateArr[j];var lng=coordArr[0];var lat=coordArr[1];var latlng=[];if(typeof lng==="number"){latlng=[lat,lng];var marker=addToHighlightMarker(latlng);GlobalMarkerObjArr.push(marker)}else if(typeof lng==="objcet"){var x=lat[0];var y=lat[1];if(typeof x==="number"&&typeof y==="number"){latlng=[x,y];var marker=addToHighlightMarker(latlng);GlobalMarkerObjArr.push(marker)}if(typeof x==="objcet"&&typeof y==="objcet"){let xx=x[0];let yy=x[1];latlng=[xx,yy];var marker=addToHighlightMarker(latlng);GlobalMarkerObjArr.push(marker)}}}}}}function getActiveLi(ulID){var uiID=document.getElementById(ulID);var list_li=uiID.getElementsByTagName("li");for(let i=0;i<list_li.length;i++){var buttonAtt=list_li[i].children[0];var attStr=buttonAtt.getAttribute("class");if(attStr.indexOf("active")){return buttonAtt.getAttribute("id")}}}function getActiveDiv(divID){var uiID=document.getElementById(divID);var list_li=uiID.getElementsByTagName("div");for(let i=0;i<list_li.length;i++){var buttonAtt=list_li[i];var attStr=buttonAtt.getAttribute("class");if(attStr.indexOf("active")){return buttonAtt.getAttribute("id")}}}function onEachFeature(feature,layer){var fillColor;layer.on({mouseover:function(e){fillColor=layer.options.fillColor;if(fillColor!="#7cffff"){e.target.setStyle({fillColor:"#7cffff"})}},mouseout:function(e){color=layer.options.fillColor;if(color=="#7cffff"){e.target.setStyle({fillColor:fillColor})}else{e.target.setStyle({fillColor:color})}}});if(feature.properties){if(feature.geometry.type==="Point"){layer.bindPopup(popupFile).on("popupopen",e=>{popupEvent(feature,layer)})}if(feature.geometry.type==="LineString"){layer.bindPopup(popupFile).on("popupopen",e=>{popupEvent(feature,layer)})}if(feature.geometry.type==="Polygon"){layer.bindPopup(popupFile).on("popupopen",e=>{popupEvent(feature,layer)})}}}function addGeojsonArrToCodeMirror(GeojsonArr,showHighlight){var att_button=getActiveLi("myTabjustified");var att_div=getActiveDiv("myTabjustifiedContent");if(att_button!=="json-tab"&&att_div!=="json-justified"){$("#json-tab").tab("show");var json_praent=document.getElementById("codeeditor-localjson");var json_cildren=json_praent.children[0];if(!json_cildren){GlobalEditor_FileGeojson=createFileGeojson();var id="codeeditor-localjson";var fileGeojson=AddInitGeojson(GlobalEditor_FileGeojson,id)}var geojson_praent=document.getElementById("json-justified");var geojson_cildren=geojson_praent.children[0];if(geojson_cildren){showFileCodeMirror(GeojsonArr);if(showHighlight){showHighlightMarker(GeojsonArr)}}var geojson_praent=document.getElementById("codeeditor-geojson");var geojson_cildren=geojson_praent.children[0];if(geojson_cildren){document.getElementById("codeeditor-geojson").innerHTML=""}GlobalTabShow_Geojson=false;GlobalTabShow_FileGeojson=true;GlobalTabShow_help=false}}function addGeojsonObjToCodeMirror(Geojsonobj){var att_button=getActiveLi("myTabjustified");var att_div=getActiveDiv("myTabjustifiedContent");if(att_button!=="json-tab"&&att_div!=="json-justified"){$("#json-tab").tab("show");var json_praent=document.getElementById("codeeditor-localjson");var json_cildren=json_praent.children[0];if(!json_cildren){GlobalEditor_FileGeojson=createFileGeojson();var id="codeeditor-localjson";var fileGeojson=AddInitGeojson(GlobalEditor_FileGeojson,id)}var geojson_praent=document.getElementById("json-justified");var geojson_cildren=geojson_praent.children[0];if(geojson_cildren){if(GlobalEditor_FileGeojson){GlobalEditor_FileGeojson.setValue(Geojsonobj)}}var geojson_praent=document.getElementById("codeeditor-geojson");var geojson_cildren=geojson_praent.children[0];if(geojson_cildren){document.getElementById("codeeditor-geojson").innerHTML=""}GlobalTabShow_Geojson=false;GlobalTabShow_FileGeojson=true;GlobalTabShow_help=false}}function showDrawToMirror(layer){var geojson_praent=document.getElementById("codeeditor-geojson");var geojson_cildren=geojson_praent.children[0];if(geojson_cildren){var geojsonStr=getLayerGeojsonConvertStr(layer);showGeojsonStrToMirror(geojsonStr)}else if(!geojson_cildren){$("#geojson-tab").tab("show");GlobalEditor_Geojson=createGeojson();var geojsonStr=getLayerGeojsonConvertStr(layer);showGeojsonStrToMirror(geojsonStr)}else{return}}function getLayerGeojsonConvertStr(layer){var geojson=getLayerGeojson(layer);var result=JSON.stringify(geojson,null,4);GlobalTabShow_Geojson=true;GlobalTabShow_FileGeojson=false;GlobalTabShow_help=false;return result}function getLayerGeojson(layer){var geojsonObj;var geojson=layer.toGeoJSON(10,false);if(typeof geojson==="string"){geojsonObj=JSON.parse(geojson)}else{geojsonObj=geojson}var id=getlayerID(layer);geojsonObj.properties.id=id;var normalizeGeojson=mergeDraw(geojsonObj);return normalizeGeojson}function showGeojsonStrToMirror(geojson){GlobalEditor_Geojson.refresh();GlobalEditor_Geojson.setValue(geojson)}function mergeDraw(inputs){var normalized=normalize(inputs);for(var j=0;j<normalized.features.length;j++){GlobalEditor_DarwGeojsonObj.features.push(normalized.features[j])}return GlobalEditor_DarwGeojsonObj}function deleteDrawLayer(layer){var layer_id=layer._leaflet_id;map.eachLayer(item=>{if(item._leaflet_id===layer_id){map.removeLayer(item)}});GlobalEditor_DarwGeojsonObj.features=GlobalEditor_DarwGeojsonObj.features.filter(item=>item.properties.id!==layer_id);var result=JSON.stringify(GlobalEditor_DarwGeojsonObj,null,4);if(GlobalEditor_Geojson){GlobalEditor_Geojson.setValue(result)}}const getCircleDrawRadius=()=>{var radius=map.pm.Draw.Circle._layer.getRadius().toFixed(2);if(radius>1e3){var r=(radius/1e3).toString();map.pm.Draw.Circle._hintMarker._tooltip.setContent("当前半径: "+r+"公里")}else{var r=radius.toString();map.pm.Draw.Circle._hintMarker._tooltip.setContent("当前半径: "+r+"米")}};function setLayerProperties(layer,layerType){var feature=layer.feature=layer.feature||{};feature.type=feature.type||"Feature";var properties=feature.properties=feature.properties||{};var geometrys=feature.geometry=feature.geometrys||{};var json=getLayerAttrbuter(layer);if(json!=null){j=jsonDataConvert(json);if(j.layetID){properties.id=j.layetID}if(j.radius){properties.radius=j.radius}if(j.area){properties.area=j.area}if(j.distance){properties.distance=j.distance}}geometrys.type=layerType}function updataGlobalEditorDarwGeojsonObj(layer,layerType){if(GlobalEditor_DarwGeojsonObj.features.length>0){var layer_id=getlayerID(layer);for(var i=0;i<GlobalEditor_DarwGeojsonObj.features.length;i++){var geojson=GlobalEditor_DarwGeojsonObj.features[i];if(geojson.properties.id==layer_id){setLayerProperties(layer,layerType);var geojsonobj=layer.toGeoJSON(10,false);GlobalEditor_DarwGeojsonObj.features[i]=geojsonobj}}}return GlobalEditor_DarwGeojsonObj}function round(num,len){return Math.round(num*Math.pow(10,len))/Math.pow(10,len)}var getLayerAttrbuter=function(layer){var latlng;var id=0;var area=0;var distance=0;var json;if(layer instanceof L.Marker){latlng=layer.getLatLng();lat=round(latlng.lat,10);lng=round(latlng.lng,10);id=getlayerID(layer);json={layetID:id,radius:0,area:0,lat:lat,lng:lng,distance:distance};return json}else if(layer instanceof L.Circle){latlng=layer.getLatLng();lat=round(latlng.lat,10);lng=round(latlng.lng,10);id=getlayerID(layer);if(radius===0){radius=map.pm.Draw.Circle._layer.getRadius().toFixed(2)}area=(Math.PI*radius*radius).toFixed(2);json={layetID:id,radius:radius,area:area,lat:lat,lng:lng,distance:0};return json}else if(layer instanceof L.CircleMarker){latlng=layer.getLatLng();lat=round(latlng.lat,10);lng=round(latlng.lng,10);id=getlayerID(layer);json={layetID:id,radius:0,area:0,lat:lat,lng:lng,distance:0};return json}else if(layer instanceof L.Polygon){id=getlayerID(layer);area=turf.area(layer.toGeoJSON(10,false)).toFixed(2);json={layetID:id,radius:0,area:area,lat:0,lng:0,distance:0};return json}else if(layer instanceof L.Polyline){var latlngs=layer._defaultShape?layer._defaultShape():layer.getLatLngs();if(latlngs.length<2){distance=0}else{for(var i=0;i<latlngs.length-1;i++){distance+=latlngs[i].distanceTo(latlngs[i+1])}id=getlayerID(layer);distance=round(distance,2);json={layetID:id,radius:0,area:area,lat:0,lng:0,distance:distance};return json}}else{return null}};function jsonDataConvert(json){var lat;var lng;var id="";var radius="";var area="";var distance="";if(json){if(json.layetID){id=json.layetID}else{id="0"}if(json.radius){if(json.radius>1e3){radius=(json.radius/1e3).toFixed(2)+"km"}else{radius=(json.radius/1).toFixed(2)+"m"}}else{radius="0"}if(json.area){if(json.area>1e6){area=(json.area/1e6).toFixed(2)+"km2"}else{area=(json.area/1).toFixed(2)+"m2"}}else{area="0"}if(json.distance){if(json.distance>1e3){distance=(json.distance/1e3).toFixed(2)+"km"}else{distance=(json.distance/1).toFixed(2)+"m"}}else{distance="0"}if(json.lat&&json.lng){lat=json.lat;lng=json.lng}else{lat="0";lng="0"}var j={layetID:id,radius:radius,area:area,lat:lat,lng:lng,distance:distance};return j}}function bindPopupDraw(layer){layer.bindPopup(popupDraw).on("popupopen",()=>{var json=getLayerAttrbuter(layer);var j;if(json){j=jsonDataConvert(json);$("#layer_id").val(j.layetID.toString());if(j.radius){var td=document.getElementById("radius");if(td){$("#radius").val(j.radius.toString())}}if(j.area){var td=document.getElementById("area");if(td){$("#area").val(j.area.toString())}}if(j.distance){var td=document.getElementById("distance");if(td){$("#distance").val(j.distance.toString())}}if(j.lat&&j.lng){var td_lat=document.getElementById("draw-lat");var td_lng=document.getElementById("draw-lng");if(td_lat&&td_lng){$("#draw-lat").val(j.lat.toString());$("#draw-lng").val(j.lng.toString())}}}})}function updataDrawPopup(layer){var json=getLayerAttrbuter(layer);var j;if(json){j=jsonDataConvert(json);$("#layer_id").val(j.layetID.toString());if(j.radius){var td=document.getElementById("radius");if(td){$("#radius").val(j.radius.toString())}}if(j.area){var td=document.getElementById("area");if(td){$("#area").val(j.area.toString())}}if(j.distance){var td=document.getElementById("distance");if(td){$("#distance").val(j.distance.toString())}}if(j.lat&&j.lng){var td_lat=document.getElementById("draw-lat");var td_lng=document.getElementById("draw-lng");if(td_lat&&td_lng){$("#draw-lat").val(j.lat.toString());$("#draw-lng").val(j.lng.toString())}}}}function deleteRow(td){var i=td.parentNode.parentNode.rowIndex;document.getElementById("draw-table").deleteRow(i)}var popupFile=`  
<div class="card " style="width: 100%; height: vh">
<div class="card-body  m-2 p-0">
    <ul class="nav nav-tabs d-flex mt-2" id="properties" role="tablist">
        <li class="nav-item flex-fill" role="presentation">
            <button class="nav-link w-100 " id="properties-tab" data-bs-toggle="tab"
                data-bs-target="#properties-justified" type="button" role="tab" aria-controls="properties"
                aria-selected="true">properties</button>
        </li>
        <li class="nav-item flex-fill" role="presentation">
            <button class="nav-link w-100 active" id="Info-tab" data-bs-toggle="tab" data-bs-target="#Info-justified"
                type="button" role="tab" aria-controls="Info" aria-selected="false">Info</button>
        </li>

    </ul>
    <div class="tab-content mt-2" id="myproperties" style="width: 100%; height:85%;">
        <div class="tab-pane fade" id="properties-justified" name="properties-justified"
            role="tabpanel" aria-labelledby="properties-tab">
            <div class="col-lg-12 " style="width: 100%; height: vh;">
                <table class="table table-bordered border-primary mt-2 table-responsive" id="tablePop">
                    <tr class="m-0 p-0">
                        <td class="m-0 p-0"><input class="form-control m-0 p-0" type="text"  style="font-size: 12px;" value=""></td>
                        <td class="m-0 p-0"><input class="form-control m-0 p-0" type="text"  style="font-size: 12px;" value=""></td>
                    </tr>
                </table>

                <div class="row m-1 p-0">
                    <div class="col-sm-5 m-0 p-0">
                        <a id="addRow" href="#"> Add row</a>
                    </div>
                    <div class="col-sm-7 m-0 p-0">
                        <a id="addProperties" href="#" class="float-end">Add properties</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane fade show active" id="Info-justified" name="Info-justified" role="tabpanel"
            aria-labelledby="Info-tab">
            <div class="col-lg-12 " style="width: 100%; height: vh;">
                <table class="table  table-bordered border-primary mt-3 " id="InfoPop">
                    <tr class="m-0 p-0">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left " type="text" 
                                style="font-size: 12px;" value="layer_id"></td>
                        <td class="m-0 p-0" ><input  class="circleMarker-id form-control m-0 p-0 " type="text" 
                                style="font-size: 12px;" value=""></td>
                    </tr>
                    <tr class="m-0 p-0 Point">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left " type="text"   style="font-size: 12px;" value="Latitude"></td>
                        <td class="m-0 p-0"><input  class="circleMarker-lat form-control m-0 p-0 " type="text" style="font-size: 12px;" value=""></td>                       
                    </tr>
                    <tr class="m-0 p-0 Point">              
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left" type="text"   style="font-size: 12px;" value="Longitude"></td>
                        <td class="m-0 p-0"><input class="circleMarker-lng form-control m-0 p-0" type="text" style="font-size: 12px;" value=""></td>
                    </tr>
                    <tr class="m-0 p-0 Polygon">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left " type="text"   style="font-size: 12px;" value="平方米"></td>
                        <td class="m-0 p-0"><input  class="Polygon-Meters form-control m-0 p-0 " type="text" style="font-size: 12px;" value=""></td>                       
                    </tr>
                    <tr class="m-0 p-0 Polygon">              
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left" type="text"  style="font-size: 12px;" value="平方公里"></td>
                        <td class="m-0 p-0"><input class="Polygon-Kilometers form-control m-0 p-0" type="text" style="font-size: 12px;" value=""></td>
                    </tr>
                    <tr class="m-0 p-0 LineString">              
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left" type="text"   style="font-size: 12px;" value="米"></td>
                        <td class="m-0 p-0"><input class="LineString-Meter form-control m-0 p-0" type="text" style="font-size: 12px;" value=""></td>
                    </tr>
                    <tr class="m-0 p-0 LineString">              
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left" type="text"  style="font-size: 12px;" value="公里"></td>
                        <td class="m-0 p-0"><input class="LineString-Kilometer form-control m-0 p-0" type="text" style="font-size: 12px;" value=""></td>
                    </tr>
                </table>
            </div>
        </div>
       <div id ="popup"></div>
    </div>
</div>

<div style="width: 200px; height:1px;border:none;border-top:1px solid gray;"></div>

<div class="row col-sm-12  m-0 p-0 mt-1">
    <div class="col-sm-12  m-0 p-0">
        <button type="button" id="save" class="saveCircleMarker btn btn-primary btn-sm" disabled="disabled">Save</button>
        <button type="button" id="cancel" class="cancelCircleMarker btn btn-secondary btn-sm ">Cancel</button>
        <button type="button" id="remove" class="removeCircleMarker float-end btn btn-primary btn-sm">Delete</button>
    </div>
</div>

</div>`;var popupMarker=` 
<div class="card " style="width: 100%; height: vh">
        <div class="card-body  m-2 p-0">
            <div class="col-lg-12 " style="width: 100%; height: vh;">
                <table class="table table-bordered border-primary mt-3 table-responsive" id="InfoMarker">
                    <tr class="m-0 p-0">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left " type="text" 
                                style="font-size: 12px;" value="layer_id"></td>
                        <td class="m-0 p-0"><input  class="marker-id form-control m-0 p-0 " type="text" 
                                style="font-size: 12px;" value=""></td>
                    </tr>
                    <tr class="m-0 p-0">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left " type="text" 
                                style="font-size: 12px;" value="Latitude"></td>
                        <td class="m-0 p-0"><input  class="marker-lat form-control m-0 p-0 " type="text" 
                                style="font-size: 12px;" value=""></td>
                    </tr>
                    <tr class="m-0 p-0">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left" type="text" 
                                style="font-size: 12px;" value="Longitude"></td>
                        <td class="m-0 p-0"><input  class="marker-lng form-control m-0 p-0" type="text" 
                                style="font-size: 12px;" value=""></td>
                    </tr>
                </table>
            </div>
        </div>
        <div style="width: 200px; height:1px;border:none;border-top:1px solid gray;"></div>

        <div class="row col-sm-12  m-0 p-0 mt-1">
            <div class="col-sm-12  m-0 p-0">
                <button type="button"  class="cancelMarker btn btn-secondary btn-sm ">Cancel</button>
                <button type="button"  class="removeMarker float-end btn btn-primary btn-sm">Delete</button>
            </div>
        </div>

    </div> 
`;var popupDraw=` 
<div class="card " style="width: 100%; height: vh">
        <div class="card-body  m-2 p-0">
            <div class="col-lg-12 " style="width: 100%; height: vh;">
                <table class="table table-bordered border-primary mt-3 table-responsive" id="draw-table">
                    <tr class="m-0 p-0">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left " type="text" 
                                style="font-size: 12px;" value="layer_id"></td>
                        <td class="m-0 p-0"><input id="layer_id" class="layer_id form-control m-0 p-0 " type="text" 
                                style="font-size: 12px;" value=""></td>
                    </tr>
                    <tr class="m-0 p-0" id ="tr-radius">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left " type="text" 
                                style="font-size: 12px;" value="radius"></td>
                        <td class="m-0 p-0"><input id="radius" class="radius form-control m-0 p-0 " type="text" 
                                style="font-size: 12px;" value=""></td>
                    </tr>
                    <tr class="m-0 p-0">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left " type="text" 
                                style="font-size: 12px;" value="area"></td>
                        <td class="m-0 p-0"><input id="area" class="area form-control m-0 p-0 " type="text" 
                                style="font-size: 12px;" value=""></td>
                    </tr>
                    <tr class="m-0 p-0">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left " type="text" 
                                style="font-size: 12px;" value="distance"></td>
                        <td class="m-0 p-0"><input id="distance" class="distance form-control m-0 p-0 " type="text" 
                                style="font-size: 12px;" value=""></td>
                    </tr>
                    <tr class="m-0 p-0">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left " type="text" 
                                style="font-size: 12px;" value="Latitude"></td>
                        <td class="m-0 p-0"><input id="draw-lat" class="draw-lat form-control m-0 p-0 " type="text" 
                                style="font-size: 12px;" value=""></td>
                    </tr>
                    <tr class="m-0 p-0">
                        <td class="m-0 p-0" style="width:40%;"><input class="form-control m-0 p-0 text-left" type="text" 
                                style="font-size: 12px;" value="Longitude"></td>
                        <td class="m-0 p-0"><input id ="draw-lng" class="draw-lng form-control m-0 p-0" type="text" 
                                style="font-size: 12px;" value=""></td>
                    </tr>
                </table>
            </div>
        </div>
        <div style="width: 200px; height:1px;border:none;border-top:1px solid gray;"></div>
    </div> 
`;