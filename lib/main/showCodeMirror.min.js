let GlobalEditor_Geojson;let GlobalEditor_FileGeojson;let GlobalEditor_Help;let GlobalTabShow_Geojson=true;let GlobalTabShow_FileGeojson=false;let GlobalTabShow_help=false;function createGeojson(){let tab_content=document.getElementById("myTabjustifiedContent");var h=tab_content.offsetHeight*.9;var darwGeojson=CodeMirror(document.getElementById("codeeditor-geojson"),{mode:"javascript",theme:"idea",tabSize:5,lineNumbers:true,autoRefresh:true,extraKeys:{Ctrl:"autocomplete"},autocorrect:true,lineWiseCopyCut:true,showCursorWhenSelecting:true,maxHighlightLength:Infinity,matchBrackets:true,smartIndent:true,firstLineNumber:1});darwGeojson.setSize("auto",h);return darwGeojson}function createFileGeojson(){let tab_content=document.getElementById("myTabjustifiedContent");var h=tab_content.offsetHeight*.9;var codeMirror_FileGeojson=CodeMirror(document.getElementById("codeeditor-localjson"),{mode:"javascript",theme:"idea",tabSize:5,lineNumbers:true,autoRefresh:true,extraKeys:{Ctrl:"autocomplete"},autocorrect:true,lineWiseCopyCut:true,showCursorWhenSelecting:true,maxHighlightLength:Infinity,matchBrackets:true,smartIndent:true,firstLineNumber:1});codeMirror_FileGeojson.setSize("auto",h);return codeMirror_FileGeojson}function createHelp(){var help=document.getElementById("codeeditor-help");help.innerHTML=`<div calss ="help" style="width:100%;height:596.7px;">
    <iframe style="width:100%;height:100%;" name="iframe1" src="help.html"></iframe>
    </div>`;return help}(function init(){GlobalEditor_Geojson=createGeojson();var id="codeeditor-geojson";var result=AddInitGeojson(GlobalEditor_Geojson,id)})();function AddInitGeojson(GlobalEditor_Geojson,id){var result;var geojson_praent=document.getElementById(id);var geojson_cildren=geojson_praent.children[0];if(geojson_cildren){var geojsonTxt='{"type":"FeatureCollection","features":[]}';result=JSON.stringify(JSON.parse(geojsonTxt),null,4);GlobalEditor_Geojson.setValue(result)}return result}function AddInitFileGeojson(GlobalEditor_FileGeojson,id){var result;var geojson_praent=document.getElementById(id);var geojson_cildren=geojson_praent.children[0];if(geojson_cildren){var geojsonTxt='{"type":"FeatureCollection","features":[]}';result=JSON.stringify(JSON.parse(geojsonTxt),null,4);GlobalEditor_FileGeojson.setValue(result)}return result}function convertGeojsonObjToString(geojson){var geojsonObj;if(typeof geojson==="object"){geojsonObj=JSON.stringify(geojson)}else{geojsonObj=geojson}var result=JSON.stringify(JSON.parse(geojsonObj),null,4);return result}$("#myTabjustified button").click(function(e){e.preventDefault();$(this).tab("show");var idValue=e.target.id;switch(idValue){case"geojson-tab":var json_praent=document.getElementById("codeeditor-localjson");var json_cildren=json_praent.children[0];if(json_cildren){document.getElementById("codeeditor-localjson").innerHTML="";GlobalTabShow_FileGeojson=false}var help_praent=document.getElementById("codeeditor-help");var help_cildren=help_praent.children[0];if(help_cildren){document.getElementById("codeeditor-help").innerHTML="";GlobalTabShow_help=false}if(GlobalEditor_DarwGeojsonObj){var geojson_praent=document.getElementById("codeeditor-geojson");var geojson_cildren=geojson_praent.children[0];if(geojson_cildren){var result=convertGeojsonObjToString(GlobalEditor_DarwGeojsonObj);GlobalEditor_Geojson.setValue(result);GlobalTabShow_Geojson=true}else{GlobalEditor_Geojson=createGeojson();var result=convertGeojsonObjToString(GlobalEditor_DarwGeojsonObj);GlobalEditor_Geojson.setValue(result);GlobalTabShow_Geojson=true}}else{GlobalEditor_Geojson=createGeojson();var geojsonValue=GlobalEditor_Geojson.getValue();if(geojsonValue.length==0){var id="codeeditor-geojson";AddInitGeojson(GlobalEditor_Geojson,id);GlobalEditor_Geojson.refresh()}GlobalTabShow_Geojson=true}break;case"json-tab":var geojson_praent=document.getElementById("codeeditor-geojson");var geojson_cildren=geojson_praent.children[0];if(geojson_cildren){document.getElementById("codeeditor-geojson").innerHTML="";GlobalTabShow_Geojson=false}var help_praent=document.getElementById("codeeditor-help");var help_cildren=help_praent.children[0];if(help_cildren){document.getElementById("codeeditor-help").innerHTML="";GlobalTabShow_help=false}if(GlobalGeojsonObj){var localjson_praent=document.getElementById("codeeditor-localjson");var localjson_cildren=localjson_praent.children[0];if(localjson_cildren){var result=convertGeojsonObjToString(GlobalGeojsonObj);GlobalEditor_FileGeojson.setValue(result);GlobalTabShow_FileGeojson=true}else{GlobalEditor_FileGeojson=createFileGeojson();var result=convertGeojsonObjToString(GlobalGeojsonObj);GlobalEditor_FileGeojson.setValue(result);GlobalTabShow_FileGeojson=true}}else{GlobalEditor_FileGeojson=createFileGeojson();var jsonValue=GlobalEditor_FileGeojson.getValue();if(jsonValue.length==0){var id="codeeditor-localjson";var fileGeojson=AddInitFileGeojson(GlobalEditor_FileGeojson,id);GlobalEditor_FileGeojson.refresh()}GlobalTabShow_FileGeojson=true}break;case"help-tab":var geojson_praent=document.getElementById("codeeditor-geojson");var geojson_cildren=geojson_praent.children[0];if(geojson_cildren){document.getElementById("codeeditor-geojson").innerHTML="";GlobalTabShow_Geojson=false}var json_praent=document.getElementById("codeeditor-localjson");var json_cildren=json_praent.children[0];if(json_cildren){document.getElementById("codeeditor-localjson").innerHTML="";GlobalTabShow_FileGeojson=false}var help_praent=document.getElementById("codeeditor-help");var help_cildren=help_praent.children[0];if(help_cildren){break}else{createHelp();GlobalTabShow_help=true}break;default:}});$(".nav-tabs").on("show.bs.tab",function(e){$(e.target).css("outline","1px solid #fd8900")}).on("hide.bs.tab",function(e){$(e.target).css("outline","none")});let btn_geojson=document.querySelector(".btnJson");btn_geojson.addEventListener("click",function(e){e.preventDefault();if(GlobalTabShow_Geojson==true){var editor_geovalue=GlobalEditor_Geojson.getValue();if(editor_geovalue.length>0){geojsonExport(editor_geovalue)}else{alert("文本框为空")}}else if(GlobalTabShow_FileGeojson==true){var editor_jsonvalue=GlobalEditor_FileGeojson.getValue();if(editor_jsonvalue.length>0){geojsonExport(editor_jsonvalue)}else{alert("文本框为空")}}else if(GlobalTabShow_help==true){return}});